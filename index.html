<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…å£°æ³¢æµ‹è·é—®é¢˜åŠ¨ç”»æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 28px;
        }

        .problem {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
        }

        .problem h2 {
            color: #667eea;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .problem p {
            line-height: 1.8;
            color: #555;
            margin-bottom: 10px;
        }

        .known-data {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .known-data h3 {
            color: #1976d2;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .known-data ul {
            list-style: none;
            padding-left: 10px;
        }

        .known-data li {
            padding: 5px 0;
            color: #555;
        }

        .known-data li::before {
            content: "â–¸ ";
            color: #1976d2;
            font-weight: bold;
        }

        .questions {
            background: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .questions h3 {
            color: #f57c00;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .questions ol {
            padding-left: 30px;
            color: #555;
        }

        .questions li {
            padding: 5px 0;
            line-height: 1.6;
        }

        .canvas-container {
            position: relative;
            background: #f0f0f0;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        canvas {
            display: block;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .controls {
            text-align: center;
            margin: 20px 0;
        }

        .control-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        button.pause-btn {
            background: linear-gradient(135deg, #FFA726 0%, #FB8C00 100%);
        }

        button.pause-btn:hover {
            box-shadow: 0 5px 20px rgba(255, 167, 38, 0.4);
        }

        button.reset-btn {
            background: linear-gradient(135deg, #66BB6A 0%, #43A047 100%);
        }

        button.reset-btn:hover {
            box-shadow: 0 5px 20px rgba(102, 187, 106, 0.4);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #f5f5f5;
            padding: 10px 20px;
            border-radius: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .control-group label {
            font-weight: bold;
            color: #555;
            font-size: 14px;
        }

        select {
            padding: 8px 15px;
            border: 2px solid #667eea;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            color: #667eea;
            cursor: pointer;
            background: white;
            outline: none;
            transition: all 0.2s;
        }

        select:hover {
            border-color: #764ba2;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .radio-group {
            display: flex;
            gap: 15px;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-weight: normal;
            color: #555;
        }

        .radio-group input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .info-panel {
            background: #fff;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 150px;
            max-height: 600px;
            overflow-y: auto;
        }

        .info-panel h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .info-text {
            color: #555;
            line-height: 1.8;
            font-size: 16px;
        }

        .highlight {
            background: #fff176;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }

        .answer {
            background: #c8e6c9;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }

        .answer strong {
            color: #2e7d32;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 30px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid #333;
        }

        .status-indicator {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 14px;
            margin-left: 10px;
        }

        .status-playing {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .status-paused {
            background: #ffecb3;
            color: #f57f17;
        }

        .status-stopped {
            background: #e0e0e0;
            color: #616161;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš— è¶…å£°æ³¢æµ‹è·é—®é¢˜ - åŠ¨ç”»æ¼”ç¤º</h1>

        <div class="problem">
            <h2>ğŸ“ é¢˜ç›®</h2>
            <p>å°åˆšå’Œå°çº¢çªå‘å¥‡æƒ³,åœ¨å„è‡ªçš„è·‘è½¦ä¸Šè£…ä¸Šäº†ä¸€ä¸ªæµ‹é€Ÿä»ª,å¹¶åœ¨èµ›è½¦åœºçš„ç›´è¡Œè·¯æ®µä½¿ç”¨,æƒ³åˆ©ç”¨æµ‹é€Ÿä»ªè¿›è¡Œæµ‹é€Ÿä¸å®šä½ã€‚</p>
            <p>å·²çŸ¥å°åˆšå’Œå°çº¢å‡<strong>å‘åŒ—åŒ€é€Ÿè¡Œé©¶</strong>,ä¸”<strong>å°çº¢å¼€åœ¨å°åˆšå‰æ–¹</strong>,æŸæ—¶åˆ»å°åˆšå‘å‰å‘å‡ºä¸€ä¸ªä¿¡å·,å°çº¢ä¹ŸåŒæ—¶å‘åå‘å‡ºä¿¡å·,1så,å°åˆšæ”¶åˆ°å°çº¢å‘å‡ºçš„ä¿¡å·,åˆè¿‡äº†2.4sæ”¶åˆ°è‡ªå·±å‘å‡ºçš„ä¿¡å·ã€‚</p>

            <div class="known-data">
                <h3>å·²çŸ¥æ¡ä»¶:</h3>
                <ul>
                    <li>å°åˆšè½¦é€Ÿ: vâ‚ = 60 m/s</li>
                    <li>è¶…å£°æ³¢é€Ÿåº¦: vå£° = 340 m/s</li>
                    <li>å°åˆšæ”¶åˆ°å°çº¢ä¿¡å·æ—¶é—´: tâ‚ = 1 s</li>
                    <li>å°åˆšæ”¶åˆ°è‡ªå·±ä¿¡å·æ—¶é—´: tâ‚‚ = 3.4 s</li>
                </ul>
            </div>

            <div class="questions">
                <h3>æ±‚è§£é—®é¢˜:</h3>
                <ol>
                    <li>ä¸¤äººå‘å‡ºä¿¡å·æ—¶çš„è·ç¦»ä¸ºå¤šå°‘ç±³?</li>
                    <li>å°çº¢çš„è½¦é€Ÿä¸ºå¤šå°‘ m/s?</li>
                    <li>å°çº¢å‘å‡ºä¿¡å·åç»å¤šå°‘ç§’æ”¶åˆ°è‡ªå·±å‘å‡ºçš„ä¿¡å·?</li>
                </ol>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #4CAF50;"></div>
                <span>å°åˆš(åè½¦)å’Œä»–çš„è¶…å£°æ³¢</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #F44336;"></div>
                <span>å°çº¢(å‰è½¦)å’Œå¥¹çš„è¶…å£°æ³¢</span>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="animationCanvas" width="1000" height="350"></canvas>
        </div>

        <div class="controls">
            <div class="control-row">
                <button id="startBtn" onclick="startAnimation()">â–¶ï¸ å¼€å§‹åŠ¨ç”»</button>
                <button id="pauseBtn" class="pause-btn" onclick="togglePause()" disabled>â¸ï¸ æš‚åœ</button>
                <button id="resetBtn" class="reset-btn" onclick="resetAnimation()">ğŸ”„ é‡ç½®</button>
                <span id="statusIndicator" class="status-indicator status-stopped">å·²åœæ­¢</span>
            </div>

            <div class="control-row">
                <div class="control-group">
                    <label>æ’­æ”¾é€Ÿåº¦:</label>
                    <select id="speedSelect" onchange="changeSpeed()">
                        <option value="0.25">0.25x (ææ…¢)</option>
                        <option value="0.5" selected>0.5x (æ…¢é€Ÿ)</option>
                        <option value="1">1x (æ­£å¸¸)</option>
                        <option value="1.5">1.5x (å¿«é€Ÿ)</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>ä¿¡å·æ˜¾ç¤º:</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="displayMode" value="point" checked onchange="changeDisplayMode()">
                            <span>ç‚¹æ¨¡å¼</span>
                        </label>
                        <label>
                            <input type="radio" name="displayMode" value="line" onchange="changeDisplayMode()">
                            <span>çº¿æ¨¡å¼</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <h3>ğŸ“Š å®æ—¶è¯´æ˜</h3>
            <div class="info-text" id="infoText">
                ç‚¹å‡»"å¼€å§‹åŠ¨ç”»"æŒ‰é’®è§‚çœ‹å®Œæ•´æ¼”ç¤ºè¿‡ç¨‹
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('animationCanvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const speedSelect = document.getElementById('speedSelect');
        const statusIndicator = document.getElementById('statusIndicator');
        const infoText = document.getElementById('infoText');

        // ç‰©ç†å‚æ•°
        const v_xiaogang = 60;      // å°åˆšè½¦é€Ÿ m/s
        const v_xiaohong = 140;     // å°çº¢è½¦é€Ÿ m/s
        const v_sound = 340;        // å£°é€Ÿ m/s
        const initial_distance = 400; // åˆå§‹è·ç¦» m

        // åŠ¨ç”»å‚æ•°
        const scale = 1.0;          // åƒç´ /ç±³çš„æ¯”ä¾‹
        let timeScale = 0.5;        // åŠ¨ç”»æ—¶é—´ç¼©æ”¾(åŠ é€Ÿæ’­æ”¾)
        let animationTime = 0;      // å½“å‰åŠ¨ç”»æ—¶é—´(ç§’)
        let animationId = null;
        let lastTime = 0;
        let isPaused = false;
        let displayMode = 'point';  // 'point' or 'line'
        let hasStoppedAtOne = false;  // æ˜¯å¦å·²ç»åœ¨1ç§’æ—¶åœæ­¢è¿‡

        // ç”»å¸ƒå‚æ•°
        const startX = 100;         // èµ·å§‹Xåæ ‡
        const roadY = 150;          // é“è·¯Yåæ ‡

        // ä¿¡å·æ•°æ®
        let signals = [];

        class Signal {
            constructor(type, startPos, direction, startTime, yOffsetGo, yOffsetReturn) {
                this.type = type;           // 'xiaogang' or 'xiaohong'
                this.startPos = startPos;   // èµ·å§‹ä½ç½®(åƒç´ )
                this.direction = direction; // 1: å‘å³, -1: å‘å·¦
                this.startTime = startTime;
                this.yOffsetGo = yOffsetGo;         // å»ç¨‹Yè½´åç§»é‡
                this.yOffsetReturn = yOffsetReturn; // å›ç¨‹Yè½´åç§»é‡
                this.reflected = false;
                this.reflectTime = 0;
                this.reflectPos = 0;
                this.completed = false;
                this.finalPos = 0;          // è®°å½•æœ€ç»ˆä½ç½®
            }

            getPosition(t) {
                if (this.completed) return null;

                const elapsed = t - this.startTime;
                if (elapsed < 0) return null;

                if (!this.reflected) {
                    // å»ç¨‹ï¼šæŒ‰å£°é€Ÿå’Œæ–¹å‘ä¼ æ’­
                    return this.startPos + this.direction * v_sound * scale * elapsed;
                } else {
                    // å›ç¨‹ï¼šåå‘ä¼ æ’­
                    const afterReflect = t - this.reflectTime;
                    return this.reflectPos - this.direction * v_sound * scale * afterReflect;
                }
            }
        }

        function drawCar(x, y, color, label, direction) {
            // ç¼©å°è½¦è¾†å°ºå¯¸
            const width = 35;
            const height = 20;

            // è½¦èº«
            ctx.fillStyle = color;
            ctx.fillRect(x - width/2, y - height/2, width, height);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.strokeRect(x - width/2, y - height/2, width, height);

            // è½¦çª—
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(x - width/2 + 5, y - height/2 + 3, width - 10, height - 6);

            // è½¦è½®
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.arc(x - width/2 + 8, y + height/2 + 3, 3, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(x + width/2 - 8, y + height/2 + 3, 3, 0, Math.PI * 2);
            ctx.fill();

            // æ–¹å‘ç®­å¤´ï¼ˆæŒ‡å‘å‰æ–¹ï¼‰
            ctx.fillStyle = '#FFF';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('â†’', x, y + 5);

            // æ ‡ç­¾
            ctx.fillStyle = '#000';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(label, x, y - 20);
        }

        function drawCarPath(startX, currentX, color, label) {
            // åœ¨é“è·¯ä¸‹æ–¹ç»˜åˆ¶è½¦è¾†è¡Œé©¶è½¨è¿¹
            const pathY = roadY + 50;  // é“è·¯ä¸‹æ–¹50åƒç´ 

            // ç»˜åˆ¶è½¨è¿¹çº¿
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.globalAlpha = 0.7;
            ctx.beginPath();
            ctx.moveTo(startX, pathY);
            ctx.lineTo(currentX, pathY);
            ctx.stroke();
            ctx.globalAlpha = 1;

            // åœ¨èµ·ç‚¹æ ‡è®°
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(startX, pathY, 4, 0, Math.PI * 2);
            ctx.fill();

            // åœ¨ç»ˆç‚¹æ ‡è®°å½“å‰ä½ç½®ï¼ˆå°åœ†ç‚¹ï¼‰
            ctx.beginPath();
            ctx.arc(currentX, pathY, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.stroke();

            // æ ‡ç­¾ï¼ˆåœ¨è½¨è¿¹çº¿ä¸Šæ–¹ï¼‰
            ctx.fillStyle = color;
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(label, startX + 5, pathY - 8);
        }

        function drawSignalPoint(x, y, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.stroke();

            // æ³¢çº¹æ•ˆæœ
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.globalAlpha = 0.5;
            ctx.beginPath();
            ctx.arc(x, y, 8, 0, Math.PI * 2);
            ctx.stroke();
            ctx.globalAlpha = 1;
        }

        function drawSignalLine(signal, currentPos, showCompletePath) {
            const color = signal.type === 'xiaogang' ? '#4CAF50' : '#F44336';

            // å»ç¨‹è·¯å¾„
            const yGo = roadY + signal.yOffsetGo;
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.globalAlpha = 0.6;

            ctx.beginPath();
            ctx.moveTo(signal.startPos, yGo);

            if (!signal.reflected) {
                // è¿˜åœ¨å»ç¨‹ä¸­
                ctx.lineTo(currentPos, yGo);
                ctx.stroke();
                ctx.globalAlpha = 1;

                // ç»˜åˆ¶å½“å‰ä½ç½®çš„ä¿¡å·ç‚¹
                drawSignalPoint(currentPos, yGo, color);
            } else {
                // å»ç¨‹å·²å®Œæˆï¼Œç»˜åˆ¶å®Œæ•´å»ç¨‹è·¯å¾„
                ctx.lineTo(signal.reflectPos, yGo);
                ctx.stroke();

                // æ ‡æ³¨åå°„ç‚¹ï¼ˆåœ¨ä¸¤æ¡è·¯å¾„ä¹‹é—´ï¼‰
                const yMid = roadY + (signal.yOffsetGo + signal.yOffsetReturn) / 2;
                ctx.globalAlpha = 1;
                ctx.fillStyle = color;
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('â†»', signal.reflectPos, yMid);

                // ç»˜åˆ¶è¿æ¥çº¿ï¼ˆä»å»ç¨‹åˆ°å›ç¨‹ï¼‰
                ctx.setLineDash([3, 3]);
                ctx.strokeStyle = color;
                ctx.lineWidth = 1;
                ctx.globalAlpha = 0.4;
                ctx.beginPath();
                ctx.moveTo(signal.reflectPos, yGo);
                const yReturn = roadY + signal.yOffsetReturn;
                ctx.lineTo(signal.reflectPos, yReturn);
                ctx.stroke();
                ctx.setLineDash([]);

                // ç»˜åˆ¶å›ç¨‹è·¯å¾„
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                ctx.globalAlpha = 0.6;
                ctx.setLineDash([8, 4]); // è™šçº¿è¡¨ç¤ºå›ç¨‹
                ctx.beginPath();
                ctx.moveTo(signal.reflectPos, yReturn);
                ctx.lineTo(currentPos, yReturn);
                ctx.stroke();
                ctx.setLineDash([]);
                ctx.globalAlpha = 1;

                // ç»˜åˆ¶å½“å‰ä½ç½®çš„ä¿¡å·ç‚¹
                if (!signal.completed || showCompletePath) {
                    drawSignalPoint(currentPos, yReturn, color);
                }
            }
        }

        function drawRoad() {
            // é“è·¯
            ctx.fillStyle = '#555';
            ctx.fillRect(0, roadY - 30, canvas.width, 60);

            // è·¯ä¸­è™šçº¿
            ctx.strokeStyle = '#FFF';
            ctx.lineWidth = 3;
            ctx.setLineDash([20, 15]);
            ctx.beginPath();
            ctx.moveTo(0, roadY);
            ctx.lineTo(canvas.width, roadY);
            ctx.stroke();
            ctx.setLineDash([]);

            // åŒ—æ–¹å‘æŒ‡ç¤ºï¼ˆå³ä¾§ï¼‰
            ctx.fillStyle = '#FFF';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('åŒ— â†’', canvas.width - 50, roadY - 50);
        }

        function drawInfo(t, pos_xiaogang_px, pos_xiaohong_px) {
            // æ—¶é—´æ˜¾ç¤º
            ctx.fillStyle = '#000';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`æ—¶é—´: ${t.toFixed(2)} s`, 20, 30);

            // æš‚åœæç¤º
            if (isPaused) {
                ctx.fillStyle = 'rgba(255, 152, 0, 0.9)';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('â¸ï¸ å·²æš‚åœ', canvas.width / 2, canvas.height - 30);
            }
        }

        function updateInfoText(t) {
            let text = '';

            if (t < 0.1) {
                text = `
                    <p><span class="highlight">t = 0 ç§’</span>: åˆå§‹æ—¶åˆ»</p>
                    <p>â€¢ å°åˆš(ç»¿è½¦)å’Œå°çº¢(çº¢è½¦)åŒæ—¶å‘å‡ºè¶…å£°æ³¢ä¿¡å·</p>
                    <p>â€¢ å°åˆšåœ¨åæ–¹,å‘<strong>å‰æ–¹(å³)</strong>å‘å‡º<strong>ç»¿è‰²</strong>ä¿¡å·</p>
                    <p>â€¢ å°çº¢åœ¨å‰æ–¹,å‘<strong>åæ–¹(å·¦)</strong>å‘å‡º<strong>çº¢è‰²</strong>ä¿¡å·</p>
                    <p>â€¢ åˆå§‹è·ç¦»: <span class="highlight">? m</span> (å¾…æ±‚)</p>
                `;
            } else if (t < 1.0) {
                text = `
                    <p><span class="highlight">t = ${t.toFixed(2)} ç§’</span></p>
                    <p>â€¢ ä¸¤è½¦éƒ½å‘å³(åŒ—)å‰è¿›</p>
                    <p>â€¢ å°çº¢çš„<strong>çº¢è‰²</strong>ä¿¡å·å‘å·¦(å)ä¼ æ’­,æ­£åœ¨è¿½èµ¶å°åˆš</p>
                    <p>â€¢ å°åˆšçš„<strong>ç»¿è‰²</strong>ä¿¡å·å‘å³(å‰)ä¼ æ’­,æ­£åœ¨è¿½èµ¶å°çº¢</p>
                `;
            } else if (t >= 1.0 && t < 3.4) {
                // 1.0ç§’åˆ°3.4ç§’ä¹‹é—´ï¼Œæ˜¾ç¤ºé—®é¢˜1çš„è§£é¢˜æ­¥éª¤
                text = `
                    <div class="answer">
                        <p><span class="highlight">t = 1.0 ç§’</span>: <strong>å…³é”®æ—¶åˆ»1</strong></p>
                        <p>âœ“ å°åˆšæ”¶åˆ°å°çº¢å‘å‡ºçš„<strong>çº¢è‰²</strong>ä¿¡å·!</p>
                        <hr style="margin: 10px 0; border: none; border-top: 2px solid #4caf50;">
                        <p><strong>ğŸ“ é—®é¢˜(1): ä¸¤äººå‘å‡ºä¿¡å·æ—¶çš„è·ç¦»ä¸ºå¤šå°‘ç±³?</strong></p>
                        <br>
                        <p><strong>è§£é¢˜æ€è·¯:</strong></p>
                        <p>1ï¸âƒ£ <strong>å°çº¢çš„è¶…å£°æ³¢ä¼ æ’­:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 1ç§’å†…,è¶…å£°æ³¢é€Ÿåº¦ vå£° = 340 m/s</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è¶…å£°æ³¢å‘åèµ°äº†: <strong>340 ç±³</strong></p>
                        <br>
                        <p>2ï¸âƒ£ <strong>å°åˆšçš„è½¦å‘å‰è¿åŠ¨:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 1ç§’å†…,å°åˆšè½¦é€Ÿ vâ‚ = 60 m/s</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°åˆšå‘å‰èµ°äº†: <strong>60 ç±³</strong></p>
                        <br>
                        <p>3ï¸âƒ£ <strong>ç›¸å‘è¿åŠ¨,è·ç¦»ç›¸åŠ :</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ åˆå§‹è·ç¦» = è¶…å£°æ³¢èµ°çš„è·ç¦» + å°åˆšèµ°çš„è·ç¦»</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ åˆå§‹è·ç¦» = 340 + 60 = <strong>400 ç±³</strong></p>
                        <br>
                        <p style="background: #fff176; padding: 8px; border-radius: 5px; font-weight: bold;">
                        âœ… ç­”æ¡ˆ: åˆå§‹è·ç¦» = 400 m</p>
                    </div>
                `;

                // å¦‚æœåœ¨1.0-3.4ç§’ä¹‹é—´ï¼Œæ·»åŠ è¿›åº¦æç¤º
                if (t < 3.4) {
                    text += `
                        <hr style="margin: 15px 0; border: none; border-top: 1px dashed #ccc;">
                        <p style="color: #666; font-style: italic;">
                        ğŸ“ å½“å‰æ—¶é—´: ${t.toFixed(2)} ç§’ | åŠ¨ç”»ç»§ç»­è¿›è¡Œä¸­,ç­‰å¾…3.4ç§’è§£ç­”é—®é¢˜(2)å’Œ(3)...
                        </p>
                    `;
                }
            } else {
                // t >= 3.4ç§’ï¼Œæ˜¾ç¤ºæ‰€æœ‰ä¸‰ä¸ªé—®é¢˜çš„è§£é¢˜æ­¥éª¤
                text = `
                    <div class="answer">
                        <h4 style="color: #2e7d32; margin-bottom: 10px;">ğŸ‰ æ¼”ç¤ºå®Œæˆ!</h4>
                        <p><span class="highlight">t = 3.4 ç§’</span>: <strong>å…³é”®æ—¶åˆ»2</strong></p>
                        <p>âœ“ å°åˆšæ”¶åˆ°è‡ªå·±å‘å‡ºçš„<strong>ç»¿è‰²</strong>ä¿¡å·(åå°„å›æ¥)</p>
                        <p>âœ“ å°çº¢ä¹Ÿæ”¶åˆ°è‡ªå·±å‘å‡ºçš„<strong>çº¢è‰²</strong>ä¿¡å·(åå°„å›æ¥)</p>

                        <hr style="margin: 15px 0; border: none; border-top: 2px solid #4caf50;">
                        <p><strong>ğŸ“ é—®é¢˜(1): ä¸¤äººå‘å‡ºä¿¡å·æ—¶çš„è·ç¦»ä¸ºå¤šå°‘ç±³?</strong></p>
                        <p style="background: #fff176; padding: 8px; border-radius: 5px; font-weight: bold; margin: 10px 0;">
                        âœ… ç­”æ¡ˆ: åˆå§‹è·ç¦» = 400 m</p>
                        <p><strong>è§£é¢˜æ€è·¯:</strong> è¶…å£°æ³¢èµ°340ç±³ + å°åˆšèµ°60ç±³ = 400ç±³</p>

                        <hr style="margin: 15px 0; border: none; border-top: 2px solid #4caf50;">
                        <p><strong>ğŸ“ é—®é¢˜(2): å°çº¢çš„è½¦é€Ÿä¸ºå¤šå°‘ m/s?</strong></p>
                        <br>
                        <p><strong>è§£é¢˜æ€è·¯:</strong></p>
                        <p>1ï¸âƒ£ <strong>å£°éŸ³æ¥å›æ€»è·¯ç¨‹:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ æ€»æ—¶é—´: t = 3.4 ç§’</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å£°éŸ³é€Ÿåº¦: vå£° = 340 m/s</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å£°éŸ³æ€»è·¯ç¨‹ = 340 Ã— 3.4 = <strong>1156 ç±³</strong></p>
                        <br>
                        <p>2ï¸âƒ£ <strong>è®¾å»ç¨‹å’Œå›ç¨‹:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è®¾å»ç¨‹(å°åˆšâ†’å°çº¢): Sâ‚</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è®¾å›ç¨‹(å°çº¢â†’å°åˆš): Sâ‚‚</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ Sâ‚ + Sâ‚‚ = 1156 ç±³ Â·Â·Â·â‘ </p>
                        <br>
                        <p>3ï¸âƒ£ <strong>å°åˆšåœ¨3.4ç§’å†…å‰è¿›:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°åˆšé€Ÿåº¦: vâ‚ = 60 m/s</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°åˆšå‰è¿›è·ç¦» = 60 Ã— 3.4 = <strong>204 ç±³</strong></p>
                        <br>
                        <p>4ï¸âƒ£ <strong>å»ç¨‹å’Œå›ç¨‹çš„å…³ç³»:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å›ç¨‹è·¯å¾„ = å»ç¨‹è·¯å¾„ - å°åˆšå‰è¿›çš„è·ç¦»</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ Sâ‚‚ = Sâ‚ - 204 Â·Â·Â·â‘¡</p>
                        <br>
                        <p>5ï¸âƒ£ <strong>è”ç«‹æ–¹ç¨‹æ±‚è§£:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°†â‘¡ä»£å…¥â‘ : Sâ‚ + (Sâ‚ - 204) = 1156</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 2Sâ‚ - 204 = 1156</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 2Sâ‚ = 1360</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ Sâ‚ = <strong>680 ç±³</strong></p>
                        <br>
                        <p>6ï¸âƒ£ <strong>è®¡ç®—å»ç¨‹æ—¶é—´:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å»ç¨‹æ—¶é—´ = Sâ‚ Ã· vå£° = 680 Ã· 340 = <strong>2 ç§’</strong></p>
                        <br>
                        <p>7ï¸âƒ£ <strong>æ±‚å°çº¢çš„é€Ÿåº¦:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 2ç§’å,å°çº¢ä½ç½® = 680 ç±³(ä»å°åˆšåˆå§‹ä½ç½®ç®—)</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°çº¢åˆå§‹ä½ç½® = 400 ç±³</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°çº¢2ç§’å†…å‰è¿› = 680 - 400 = <strong>280 ç±³</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°çº¢é€Ÿåº¦ = 280 Ã· 2 = <strong>140 m/s</strong></p>
                        <br>
                        <p style="background: #fff176; padding: 8px; border-radius: 5px; font-weight: bold;">
                        âœ… ç­”æ¡ˆ: å°çº¢è½¦é€Ÿ vâ‚‚ = 140 m/s</p>

                        <hr style="margin: 15px 0; border: none; border-top: 2px solid #4caf50;">
                        <p><strong>ğŸ“ é—®é¢˜(3): å°çº¢å‘å‡ºä¿¡å·åç»å¤šå°‘ç§’æ”¶åˆ°è‡ªå·±å‘å‡ºçš„ä¿¡å·?</strong></p>
                        <br>
                        <p><strong>è§£é¢˜æ€è·¯:</strong></p>
                        <p>1ï¸âƒ£ <strong>å°çº¢è¶…å£°æ³¢å»ç¨‹(1ç§’):</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ ä»é—®é¢˜(1)å·²çŸ¥: 1ç§’åè¶…å£°æ³¢ç¢°åˆ°å°åˆš</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è®¾å»ç¨‹è·ç¦»: Sâ‚… = 340 ç±³</p>
                        <br>
                        <p>2ï¸âƒ£ <strong>è®¾æ€»æ—¶é—´ä¸º t:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°çº¢é€Ÿåº¦: vâ‚‚ = 140 m/s(å·²æ±‚å‡º)</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°çº¢åœ¨tç§’å†…èµ°çš„è·ç¦»: Sâ‚„ = 140t</p>
                        <br>
                        <p>3ï¸âƒ£ <strong>è¶…å£°æ³¢æ€»è·¯ç¨‹:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è¶…å£°æ³¢é€Ÿåº¦: vå£° = 340 m/s</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è¶…å£°æ³¢tç§’æ€»è·¯ç¨‹ = 340t</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ è®¾å›ç¨‹è·ç¦»: Sâ‚†</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ Sâ‚… + Sâ‚† = 340t Â·Â·Â·â‘ </p>
                        <br>
                        <p>4ï¸âƒ£ <strong>å›ç¨‹è¦è¿½ä¸Šç§»åŠ¨çš„å°çº¢:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å›ç¨‹è·¯å¾„ = å°çº¢èµ°çš„è·ç¦» + å»ç¨‹è·ç¦»</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ Sâ‚† = Sâ‚„ + Sâ‚… Â·Â·Â·â‘¡</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ Sâ‚† = 140t + 340</p>
                        <br>
                        <p>5ï¸âƒ£ <strong>è”ç«‹æ–¹ç¨‹æ±‚è§£:</strong></p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ å°†â‘¡ä»£å…¥â‘ : 340 + (140t + 340) = 340t</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 680 + 140t = 340t</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 680 = 340t - 140t</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ 680 = 200t</p>
                        <p>&nbsp;&nbsp;&nbsp;â€¢ t = 680 Ã· 200 = <strong>3.4 ç§’</strong></p>
                        <br>
                        <p style="background: #fff176; padding: 8px; border-radius: 5px; font-weight: bold;">
                        âœ… ç­”æ¡ˆ: å°çº¢æ”¶åˆ°ä¿¡å·æ—¶é—´ = 3.4 s</p>

                        <hr style="margin: 15px 0; border: none; border-top: 3px solid #2e7d32;">
                        <p><strong>ğŸ¯ å…³é”®ç†è§£:</strong></p>
                        <p>1ï¸âƒ£ <strong>ç›¸å‘è¿åŠ¨</strong>: è·ç¦»ç›¸åŠ  (é—®é¢˜1)</p>
                        <p>2ï¸âƒ£ <strong>è¿½åŠé—®é¢˜</strong>: å»ç¨‹è·¯å¾„ - ç§»åŠ¨è·ç¦» = å›ç¨‹è·¯å¾„ (é—®é¢˜2)</p>
                        <p>3ï¸âƒ£ <strong>è¿½èµ¶é—®é¢˜</strong>: å›ç¨‹è¦è¿½ä¸Šç§»åŠ¨çš„ç›®æ ‡ (é—®é¢˜3)</p>
                        <p>4ï¸âƒ£ <strong>åˆ—æ–¹ç¨‹</strong>: æ ¹æ®è·¯ç¨‹å…³ç³»å»ºç«‹æ–¹ç¨‹æ±‚è§£</p>
                    </div>
                `;
            }

            infoText.innerHTML = text;
        }

        function updateStatus() {
            if (animationId === null) {
                statusIndicator.className = 'status-indicator status-stopped';
                statusIndicator.textContent = 'å·²åœæ­¢';
            } else if (isPaused) {
                statusIndicator.className = 'status-indicator status-paused';
                statusIndicator.textContent = 'å·²æš‚åœ';
            } else {
                statusIndicator.className = 'status-indicator status-playing';
                statusIndicator.textContent = 'æ’­æ”¾ä¸­';
            }
        }

        function animate(currentTime) {
            if (!isPaused) {
                if (lastTime === 0) lastTime = currentTime;
                const deltaTime = (currentTime - lastTime) / 1000 * timeScale;
                lastTime = currentTime;

                animationTime += deltaTime;
            }

            // è®¡ç®—è½¦è¾†ä½ç½®(åƒç´ åæ ‡)
            const pos_xiaogang_px = startX + v_xiaogang * scale * animationTime;
            const pos_xiaohong_px = startX + initial_distance * scale + v_xiaohong * scale * animationTime;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶é“è·¯(å›ºå®šä¸åŠ¨)
            drawRoad();

            // ç»˜åˆ¶è½¦è¾†è¡Œé©¶è½¨è¿¹ï¼ˆåœ¨é“è·¯ä¸‹æ–¹ï¼‰
            drawCarPath(startX, pos_xiaogang_px, '#4CAF50', 'å°åˆšè·¯å¾„');
            drawCarPath(startX + initial_distance * scale, pos_xiaohong_px, '#F44336', 'å°çº¢è·¯å¾„');

            // ç»˜åˆ¶è½¦è¾†(å‘å³ç§»åŠ¨)
            drawCar(pos_xiaogang_px, roadY, '#4CAF50', 'å°åˆš', 1);
            drawCar(pos_xiaohong_px, roadY, '#F44336', 'å°çº¢', 1);

            // ç®¡ç†ä¿¡å·
            if (animationTime >= 0 && signals.length === 0) {
                // åˆ›å»ºåˆå§‹ä¿¡å·
                // å°åˆšçš„ä¿¡å·ï¼šå‘å³(å‰)ä¼ æ’­ï¼Œå»ç¨‹åœ¨ä¸Šæ–¹ï¼Œå›ç¨‹åœ¨ç¨ä¸‹æ–¹
                signals.push(new Signal('xiaogang', pos_xiaogang_px, 1, 0, -20, -10));
                // å°çº¢çš„ä¿¡å·ï¼šå‘å·¦(å)ä¼ æ’­ï¼Œå»ç¨‹åœ¨ä¸‹æ–¹ï¼Œå›ç¨‹åœ¨ç¨ä¸Šæ–¹
                signals.push(new Signal('xiaohong', pos_xiaohong_px, -1, 0, 20, 10));
            }

            // æ›´æ–°å’Œç»˜åˆ¶ä¿¡å·
            signals.forEach(signal => {
                // è®¡ç®—å½“å‰è½¦è¾†ä½ç½®ç”¨äºåå°„åˆ¤æ–­
                const xiaogang_pos = startX + v_xiaogang * scale * animationTime;
                const xiaohong_pos = startX + initial_distance * scale + v_xiaohong * scale * animationTime;

                // è·å–ä¿¡å·å½“å‰ä½ç½®
                let signalPos = signal.getPosition(animationTime);

                // å¦‚æœä¿¡å·è¿˜åœ¨ä¼ æ’­ä¸­ï¼Œè¿›è¡Œåå°„å’Œå®Œæˆåˆ¤æ–­
                if (signalPos !== null && !signal.completed) {
                    // æ£€æŸ¥åå°„
                    if (!signal.reflected) {
                        if (signal.type === 'xiaogang') {
                            // å°åˆšçš„ç»¿è‰²ä¿¡å·å‘å³ä¼ æ’­ï¼Œæ£€æŸ¥æ˜¯å¦è¿½ä¸Šå°çº¢
                            if (signalPos >= xiaohong_pos) {
                                signal.reflected = true;
                                signal.reflectTime = animationTime;
                                signal.reflectPos = xiaohong_pos;
                            }
                        } else {
                            // å°çº¢çš„çº¢è‰²ä¿¡å·å‘å·¦ä¼ æ’­ï¼Œæ£€æŸ¥æ˜¯å¦è¿½ä¸Šå°åˆš
                            if (signalPos <= xiaogang_pos) {
                                signal.reflected = true;
                                signal.reflectTime = animationTime;
                                signal.reflectPos = xiaogang_pos;
                            }
                        }
                    } else {
                        // æ£€æŸ¥æ˜¯å¦è¿”å›åˆ°å‘é€è€…
                        if (signal.type === 'xiaogang') {
                            // ç»¿è‰²ä¿¡å·è¿”å›å°åˆš
                            if (signalPos <= xiaogang_pos) {
                                signal.completed = true;
                                signal.finalPos = xiaogang_pos;  // ä¿å­˜æœ€ç»ˆä½ç½®
                            }
                        } else {
                            // çº¢è‰²ä¿¡å·è¿”å›å°çº¢
                            if (signalPos >= xiaohong_pos) {
                                signal.completed = true;
                                signal.finalPos = xiaohong_pos;  // ä¿å­˜æœ€ç»ˆä½ç½®
                            }
                        }
                    }
                }

                // ç»˜åˆ¶ä¿¡å·ï¼ˆåŒ…æ‹¬å·²å®Œæˆçš„ä¿¡å·ï¼‰
                const color = signal.type === 'xiaogang' ? '#4CAF50' : '#F44336';
                // æ ¹æ®æ˜¯å¦åå°„é€‰æ‹©Yåæ ‡
                const y = signal.reflected ?
                    (roadY + signal.yOffsetReturn) :
                    (roadY + signal.yOffsetGo);
                // ä½¿ç”¨æœ€ç»ˆä½ç½®ï¼ˆå¦‚æœå·²å®Œæˆï¼‰æˆ–å½“å‰ä½ç½®
                const displayPos = signal.completed ? signal.finalPos : signalPos;

                if (displayPos !== null) {
                    if (displayMode === 'line') {
                        drawSignalLine(signal, displayPos, signal.completed);
                    } else {
                        // ç‚¹æ¨¡å¼ - åªåœ¨æœªå®Œæˆæ—¶æ˜¾ç¤ºç‚¹
                        if (!signal.completed) {
                            drawSignalPoint(displayPos, y, color);
                        }
                    }
                }
            });

            // ç»˜åˆ¶ä¿¡æ¯
            drawInfo(animationTime, pos_xiaogang_px, pos_xiaohong_px);
            if (!isPaused) {
                updateInfoText(animationTime);
            }

            // ç»§ç»­åŠ¨ç”» - å…ˆåœ¨1ç§’æ—¶åœæ­¢å±•ç¤ºç¬¬ä¸€é¢˜ï¼Œç„¶åç»§ç»­åˆ°3.4ç§’
            if (!hasStoppedAtOne && animationTime >= 1.0) {
                // ç¬¬ä¸€æ¬¡åˆ°è¾¾1ç§’ï¼Œåœæ­¢å¹¶å±•ç¤ºç¬¬ä¸€é¢˜è§£ç­”
                animationId = null;
                hasStoppedAtOne = true;
                startBtn.disabled = false;
                startBtn.textContent = 'â–¶ï¸ ç»§ç»­æ’­æ”¾';
                pauseBtn.disabled = true;
                updateStatus();
                updateInfoText(1.0);
            } else if (hasStoppedAtOne && animationTime < 3.4) {
                // å·²ç»åœ¨1ç§’åœæ­¢è¿‡ï¼Œç»§ç»­æ’­æ”¾åˆ°3.4ç§’
                animationId = requestAnimationFrame(animate);
            } else if (animationTime >= 3.4) {
                // åˆ°è¾¾3.4ç§’ï¼Œæœ€ç»ˆåœæ­¢
                animationId = null;
                startBtn.disabled = false;
                startBtn.textContent = 'â–¶ï¸ é‡æ–°æ’­æ”¾';
                pauseBtn.disabled = true;
                updateStatus();
                updateInfoText(3.4);
            } else if (!hasStoppedAtOne && animationTime < 1.0) {
                // è¿˜æ²¡åˆ°1ç§’ï¼Œç»§ç»­æ’­æ”¾
                animationId = requestAnimationFrame(animate);
            }
        }

        function startAnimation() {
            if (animationId !== null) {
                cancelAnimationFrame(animationId);
            }

            // å¦‚æœåœ¨1ç§’æ—¶åœæ­¢äº†ï¼Œç‚¹å‡»ç»§ç»­æ’­æ”¾ï¼›å¦åˆ™é‡æ–°å¼€å§‹
            if (!hasStoppedAtOne || startBtn.textContent === 'â–¶ï¸ é‡æ–°æ’­æ”¾') {
                // é‡æ–°å¼€å§‹
                animationTime = 0;
                lastTime = 0;
                signals = [];
                isPaused = false;
                hasStoppedAtOne = false;
            } else {
                // ä»1ç§’ç»§ç»­æ’­æ”¾
                lastTime = 0; // é‡ç½®lastTimeé¿å…æ—¶é—´è·³è·ƒ
            }

            startBtn.disabled = true;
            pauseBtn.disabled = false;
            pauseBtn.textContent = 'â¸ï¸ æš‚åœ';

            animationId = requestAnimationFrame(animate);
            updateStatus();
        }

        function togglePause() {
            if (animationId === null) return;

            isPaused = !isPaused;

            if (isPaused) {
                pauseBtn.textContent = 'â–¶ï¸ ç»§ç»­';
            } else {
                pauseBtn.textContent = 'â¸ï¸ æš‚åœ';
                lastTime = 0; // é‡ç½®æ—¶é—´é¿å…è·³è·ƒ
            }

            updateStatus();
        }

        function resetAnimation() {
            if (animationId !== null) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }

            animationTime = 0;
            lastTime = 0;
            signals = [];
            isPaused = false;
            hasStoppedAtOne = false;  // é‡ç½®åœæ­¢æ ‡è®°

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawRoad();

            // åˆå§‹ä½ç½®
            const pos_xiaogang_px = startX;
            const pos_xiaohong_px = startX + initial_distance * scale;

            // ç»˜åˆ¶åˆå§‹è½¨è¿¹ç‚¹ï¼ˆèµ·ç‚¹ï¼‰
            drawCarPath(startX, pos_xiaogang_px, '#4CAF50', 'å°åˆšè·¯å¾„');
            drawCarPath(startX + initial_distance * scale, pos_xiaohong_px, '#F44336', 'å°çº¢è·¯å¾„');

            drawCar(pos_xiaogang_px, roadY, '#4CAF50', 'å°åˆš', 1);
            drawCar(pos_xiaohong_px, roadY, '#F44336', 'å°çº¢', 1);
            drawInfo(0, pos_xiaogang_px, pos_xiaohong_px);

            infoText.innerHTML = 'ç‚¹å‡»"å¼€å§‹åŠ¨ç”»"æŒ‰é’®è§‚çœ‹å®Œæ•´æ¼”ç¤ºè¿‡ç¨‹';
            startBtn.disabled = false;
            startBtn.textContent = 'â–¶ï¸ å¼€å§‹åŠ¨ç”»';
            pauseBtn.disabled = true;
            pauseBtn.textContent = 'â¸ï¸ æš‚åœ';
            updateStatus();
        }

        function changeSpeed() {
            timeScale = parseFloat(speedSelect.value);
        }

        function changeDisplayMode() {
            const selected = document.querySelector('input[name="displayMode"]:checked');
            displayMode = selected.value;
        }

        // åˆå§‹åŒ–
        resetAnimation();
    </script>
</body>
</html>